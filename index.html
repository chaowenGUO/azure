<!DOCTYPE html>
<html>
  <head>
      <meta charset='utf-8'>
      <title>latex</title>
      <script src='https://pyodide-cdn2.iodide.io/v0.15.0/full/pyodide.js'></script>
      <script src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'></script>
  </head>
  <body>
      <math></math>
      <script type='module'>
          await languagePluginLoader
          await pyodide.loadPackage('sympy')
          let response = await globalThis.fetch('index.py')
          response = response.ok ? await response.text() : ''
          globalThis.document.querySelector('math').innerHTML = pyodide.runPython(response)
        //let promise = Promise.resolve();  // Used to hold chain of typesetting calls

/*function typeset(code) {
  promise = promise.then(() => {code(); return MathJax.typesetPromise()})
                   .catch((err) => console.log('Typeset failed: ' + err.message));
  return promise;
}
        typeset(() => {
  const math = document.querySelector('div');
  math.innerHTML = String.raw`\(\dfrac{a}{1-a^2}\)`
  return math;
});*/
/*        const math = document.querySelector('math')
  math.innerHTML = `<mrow>
      <mrow>
         <msup> <mi>x</mi> <mn>2</mn> </msup> <mo>+</mo>
         <mrow>
            <mn>4</mn>
            <mo>‚Å¢</mo>
            <mi>x</mi>
         </mrow>
         <mo>+</mo>
         <mn>4</mn>
      </mrow>
      
      <mo>=</mo>
      <mn>0</mn>
   </mrow>`*/
  //Mathjax.typeSet()
      </script>
  </body>
</html>
